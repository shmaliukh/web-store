<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <script src="/utils.js"></script>
    <title>Add item</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link th:insert="blocks/attachments.html :: links">
</head>
<body>
<header th:insert="blocks/admin/header"></header>

<div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 text-center my-md-4">
    <h1 class="display-4">Add item panel</h1>
    <hr>
    <p class="lead">You can add new item</p>
    <p class="lead">Add item images after submitting form</p>
</div>


<div class="container">
    <div class="album mb-3 bg-light text-center">
        <div class="card mb-4 box-shadow">
            <div class="card-header">
                <h3 class="my-0 font-weight-normal" th:text="|New ${itemType.toUpperCase()} card|">New item card</h3>
            </div>
            <div class="card-body">
                <form id="formElem" class="needs-validation">
                    <div class="row g-3">
                        <div class="col-12">
                            <label for="selectCategory" class="form-label">Category</label>
                            <div class="input-group has-validation">
                                <select id="selectCategory" name="category" class="form-select">
                                    <option selected=""
                                            th:text="${categoryName != null ? categoryName : 'Choose...'}"
                                            th:value="${categoryName != null ? categoryName : ''}">
                                    </option>
                                    <script th:inline="javascript">
                                        generateOptionUsingDataFromApi("selectCategory", "http://localhost:8082/category/names");
                                    </script>
                                </select>
                                <div class="invalid-feedback">
                                    Item category is required.
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label for="itemName" class="form-label">Item name</label>
                            <div class="input-group has-validation">
                                <span class="input-group-text">@</span>
                                <input type="text" name="name" class="form-control" id="itemName" placeholder="Item name"
                                       required="">
                                <div class="invalid-feedback">
                                    Item name is required.
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label for="costPrice" class="form-label">Cost price</label>
                            <div class="input-group mb-3 has-validation">
                                <span class="input-group-text">$</span>
                                <input type="number" name="costPrice" class="form-control" id="costPrice" placeholder="0" min="0" required="">
                                <div class="invalid-feedback">
                                    Item cost price is required.
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label for="salePrice" class="form-label">Sale price</label>
                            <div class="input-group mb-3 has-validation">
                                <span class="input-group-text">$</span>
                                <!--                                TODO implement script to change 'min' value (min value = costPrice)-->
                                <input type="number" name="salePrice" class="form-control" id="salePrice" placeholder="0" min="0" required="">
                                <div class="invalid-feedback">
                                    Valid item sale price is required.
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label for="availableToBuyQuantity" class="form-label">Available quantity to sell</label>
                            <div class="input-group mb-3 has-validation">
                                <input type="number" name="availableToBuyQuantity" class="form-control" id="availableToBuyQuantity" placeholder="1" min="0"
                                       required="">
                                <div class="invalid-feedback">
                                    Item quantity is required.
                                </div>
                            </div>
                        </div>

                        <div class="col-12">
                            <label for="currentQuantity" class="form-label">Current quantity</label>
                            <div class="input-group mb-3 has-validation">
                                <input type="number" name="currentQuantity" class="form-control" id="currentQuantity" placeholder="1" min="0"
                                       required="">
                                <div class="invalid-feedback">
                                    Item quantity is required.
                                </div>
                            </div>
                        </div>

                        <div class="col-12">
                            <label for="description" class="form-label">Description</label>
                            <textarea id="description" name="description" class="form-control" placeholder="Product description"></textarea>
                        </div>

                        <div class="col-12">
                            <label for="selectStatus" class="form-label">Status</label>
                            <div class="input-group has-validation">
                                <select id="selectStatus" name="status" class="form-select">
                                    <option selected="">Choose...</option>
                                    <script th:inline="javascript">
                                        generateOptionUsingDataFromApi("selectStatus", "http://localhost:8082/item/status-names");
                                    </script>
                                </select>
                                <div class="invalid-feedback">
                                    Item status is required.
                                </div>
                            </div>
                        </div>

                        <div th:insert="blocks/add-item-form-blocks.html :: ${itemType}"></div>

                        <div class="d-flex justify-content-around align-items-center">
                            <div class="form-check form-switch">
                                <input class="form-check-input" name="isAvailableInStore" type="checkbox" role="switch"
                                       id="flexSwitchCheckChecked" value="true" checked>
                                <label class="form-check-label" for="flexSwitchCheckChecked">Is available</label>
                            </div>
                        </div>

                        <small class="text-muted">Do not forget to fill all fields</small>

                    </div>
                    <hr>
                    <button class="w-100 btn btn-primary btn-lg" type="submit">Create new item</button>
                </form>
            </div>
            <script th:inline="javascript">
                formElem.onsubmit = async (e) => {
                    e.preventDefault();
                    fetchAddingItemFormWithJsonBodyWithItemClassType("formElem", "/admin/item/add", "post", "/admin/item/catalog", [[${itemType}]]);
                };
            </script>
        </div>
    </div>
</div>

<footer th:insert="blocks/page-blocks.html :: footer"></footer>
</body>
</html>